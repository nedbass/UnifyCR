

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Build &amp; I/O Interception &mdash; UnifyCR 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="UnifyCR 0.1 documentation" href="index.html"/>
        <link rel="next" title="Mounting UnifyCR" href="api-mount.html"/>
        <link rel="prev" title="Assumptions" href="assumptions.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html">
          

          
            
            <img src="_static/unify-logo.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="definitions.html">Definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="assumptions.html">Assumptions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Build &amp; I/O Interception</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#how-to-build-unifycr">How to build UnifyCR</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#building-with-spack"><strong>Building with Spack</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-without-spack"><strong>Building without Spack</strong></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#i-o-interception">I/O Interception</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#statically">Statically</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamically">Dynamically</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api-mount.html">Mounting UnifyCR</a></li>
<li class="toctree-l1"><a class="reference internal" href="start-stop.html">Starting &amp; Stopping</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">UnifyCR</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Build &amp; I/O Interception</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/build-intercept.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="build-i-o-interception">
<h1>Build &amp; I/O Interception<a class="headerlink" href="#build-i-o-interception" title="Permalink to this headline">¶</a></h1>
<div class="section" id="how-to-build-unifycr">
<h2>How to build UnifyCR<a class="headerlink" href="#how-to-build-unifycr" title="Permalink to this headline">¶</a></h2>
<p>Download the latest UnifyCR release from the <a class="reference external" href="https://github.com/LLNL/UnifyCR/releases">Releases</a> page. UnifyCR requires MPI,
LevelDB, and GOTCHA.</p>
<div class="section" id="building-with-spack">
<h3><strong>Building with Spack</strong><a class="headerlink" href="#building-with-spack" title="Permalink to this headline">¶</a></h3>
<p>Install leveldb and gotcha and set up your build environment, we recommend using
the spack package manager. For example, the following commands will build and
install leveldb and gotcha using spack and configure your environment so UnifyCR
can find the libraries and headers it needs:</p>
<div class="highlight-Bash"><div class="highlight"><pre><span></span>git clone https://github.com/spack/spack
. spack/share/spack/setup-env.sh
spack install leveldb
spack install gotcha
spack install environment-modules
spack load environment-modules
<span class="nb">source</span> &lt;<span class="o">(</span>spack module loads gotcha leveldb<span class="o">)</span>
</pre></div>
</div>
<p>Then to build UnifyCR:</p>
<div class="highlight-Bash"><div class="highlight"><pre><span></span>./configure --prefix<span class="o">=</span>/path/to/install --enable-debug
make
make install
</pre></div>
</div>
</div>
<div class="section" id="building-without-spack">
<h3><strong>Building without Spack</strong><a class="headerlink" href="#building-without-spack" title="Permalink to this headline">¶</a></h3>
<p>For users who cannot use spack, you may fetch the latest release of
<a class="reference external" href="https://github.com/LLNL/GOTCHA">GOTCHA</a></p>
<p>Then to build with UnifyCR:</p>
<div class="highlight-Bash"><div class="highlight"><pre><span></span>./configure --prefix<span class="o">=</span>/path/to/install --with-gotcha<span class="o">=</span>/path/to/gotcha
        --enable-debug
make
make install
</pre></div>
</div>
</div>
</div>
<div class="section" id="i-o-interception">
<h2>I/O Interception<a class="headerlink" href="#i-o-interception" title="Permalink to this headline">¶</a></h2>
<p><strong>POSIX calls can be intercepted via the methods described below.</strong></p>
<div class="section" id="statically">
<h3>Statically<a class="headerlink" href="#statically" title="Permalink to this headline">¶</a></h3>
<p><strong>Steps for static linking using –wrap:</strong></p>
<p>To intercept I/O calls using a static link, you must add flags to your link
line. UnifyCR installs a unifycr-config script that returns those flags, e.g.,</p>
<div class="highlight-Bash"><div class="highlight"><pre><span></span>mpicc -o test_write <span class="se">\</span>
          <span class="sb">`</span>&lt;unifycr&gt;/bin/unifycr-config --pre-ld-flags<span class="sb">`</span> <span class="se">\</span>
            test_write.c <span class="se">\</span>
                  <span class="sb">`</span>&lt;unifycr&gt;/bin/unifycr-config --post-ld-flags<span class="sb">`</span>
</pre></div>
</div>
</div>
<div class="section" id="dynamically">
<h3>Dynamically<a class="headerlink" href="#dynamically" title="Permalink to this headline">¶</a></h3>
<p><strong>Steps for dynamic linking using gotcha:</strong></p>
<p>To intercept I/O calls using gotcha, use the following syntax to link an
application.</p>
<div class="highlight-Bash"><div class="highlight"><pre><span></span>mpicc -o test_write test_write.c <span class="se">\</span>
        -I&lt;unifycr&gt;/include -L&lt;unifycy&gt;/lib -lunifycr_gotcha <span class="se">\</span>
        -L&lt;gotcha&gt;/lib64 -lgotcha
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api-mount.html" class="btn btn-neutral float-right" title="Mounting UnifyCR" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="assumptions.html" class="btn btn-neutral" title="Assumptions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Lawrence Livermore National Security LLC LLNL-CODE-741539, UT-Batelle LLC.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>